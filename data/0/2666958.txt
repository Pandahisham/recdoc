Patient-Specific Volume Conductor Modeling for Non-Invasive Imaging of Cardiac Electrophysiology

These authors contributed equally.
This is an open access article licensed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/3.0/) which permits unrestricted, non-commercial use, distribution and reproduction in any medium, provided the work is properly cited.
We propose a general workflow to numerically estimate the spread of electrical excitation in the patients’ hearts. To this end, a semi-automatic segmentation pipeline for extracting the volume conductor model of structurally normal hearts is presented. The cardiac electrical source imaging technique aims to provide information about the spread of electrical excitation in order to assist the cardiologist in developing strategies for the treatment of cardiac arrhythmias. The volume conductor models of eight patients were extracted from cine-gated short-axis magnetic resonance imaging (MRI) data. The non-invasive estimation of electrical excitation was compared with the CARTO™ maps. The development of a volume conductor modeling pipeline for constructing a patient-specific volume conductor model in a fast and accurate way is one essential step to make the technique clinically applicable.

Computer modeling of bioelectric activity is of interest in cardiac electrophysiology [1-3] and, furthermore, the non-invasive imaging of the electrical excitation from electrocardiogram (ECG) has become a diagnosis tool in clinical applications [4, 5]. For non-invasive imaging of the electrical function four dimensional (3D and time) anatomical and ECG mapping data have to be combined. This enables the computation of the electrocardiographic inverse problem, which is commonly referred to as the estimation of the source from measured fields. The anatomical data are obtained via magnetic resonance imaging (MRI). These volume data provide the basis for generating a patient-specific volume conductor model (VCM). In order to solve the inverse problem for imaging the electrical excitation a VCM is needed. A VCM comprises the electrically most active compartments: chest surface, lung surface, atrial and ventricular myocardium and the cardiac blood masses [6]. The ECG mapping data are acquired with a multi-channel ECG recording system [7, 8]. In the electrocardiographic inverse problem, the electrical source distribution is reconstructed from body surface maps by employing an electrical source-model description. Because of the generally unknown individual cardiac fiber orientation, electrical isotropy is assumed in the surface heart model approach based on the bidomain theory [9-11].
The cardiac electrical source imaging technique provides information about the spread of electrical excitation in order to assist the cardiologist in developing strategies for treatment of cardiac arrhythmias. In many cases it is possible to trace back common cardiac arrhythmias to accessory pathways, atrial or ventricular foci, e.g., from the pulmonary veins [12], and reentrant circuits [13]. Identifying the site of origin of the ectopic focus or the location of an accessory pathway provides essential information for treatment strategies, like catheter ablation [14].
In clinical practice the localization of ectopic origins is currently achieved by traditional catheter techniques and by recently introduced catheter mapping systems, like the CARTO™ system [15]. The major advantage of the CARTO™ system is that it enables the combination between electrical and spatial endocardial information, which supports the cardiologist in getting a deeper insight in the patients’ arrhythmias. CARTO™ provides electro-anatomical information that assists the cardiologist in applying linear lesions. CARTO™ shows significant limitations when it comes to acquiring single-beat activation maps and, furthermore, these are mostly applied to single target chambers only. Another important fact is that it is impossible to obtain information from the epicardium under clinical conditions. Moreover, this invasive technique imposes a higher risk to the patient during the procedure. These limitations can be bypassed by providing the electrical excitation non-invasively, by applying the non-invasive imaging of cardiac electrophysiology (NICE) approach. The goal was the development of a modeling pipeline that enables our approach to become clinically applicable.
To enable non-invasive cardiac imaging a modus operandi was defined that needs to be followed in order to process the pipeline. In the first modeling step the anatomy of the patient has to be acquired. This is performed by MRI using a Magnetom-Vision-Plus 1.5 T (Siemens Medical Solutions) scanner. The atrial and ventricular geometry is recorded in CINE-mode during breath-hold (expiration, short-axis scans, 4-6 mm spacing). The shape of the lungs and the torso are recorded in T1-FLASH-mode during breath-hold (expiration, long-axis scans, 10 mm spacing). For locating and coupling the mapping electrodes vitamin E capsules were used, because these markers are clearly visible in the MRI images and can be easily identified. Seven markers (anatomical landmarks on the anterior and lateral chest wall) were used to couple the locations of the electrodes to the MRI frame. Eleven capsules were attached on the back, in order to tag the positions of the posterior electrodes, which were not accessible during the electrophysiology study (EPS). The positions of the anterior and lateral electrodes were digitized using the Fastrak system (Polhemus Inc.). Additionally, the locations of the 7 anatomical landmarks were digitized in order to allow transformation into the MRI frame. A VCM with visualized electrode positions using spheres is depicted in Fig. (1).
The next step is the volume conductor modeling task using two volume data sets. The short-axis data is used for the cardiac modeling of the blood masses, the ventricles’ myocardium and the atria. The axial data set is used for modeling the lung and chest surfaces. When the extraction procedure is finished the compartments are coupled together to the so-called volume conductor model. This modeling part needs to be done in a short time period because the time between the MRI procedure and the catheter intervention is normally limited by two hours.
The third step is accomplished in the catheter laboratory and is known as EPS. The electrical recordings from different locations in the heart and the response to electrical stimulation via the wires allow detailed information about the cause of the palpitations to be identified. The EPS is a diagnostic procedure to obtain a reading of the impulses, which cause irregular heart beats from the interior of the heart. If the diseased location is found the cardiologist medicates via ablation [14]. When estimating the electrical excitation a multi-lead ECG is derived from the patients’ body surface. The derived ECG signals are then pre-filtered and baseline corrected. With this initial estimation the cardiologist is able to find the location of the accessory pathway by using the standard mapping system CARTO™ (Biosense Webster Inc.) and disconnects the pathway by ablation [14].
After this procedure the accessory pathways location is estimated (in case of e.g., Wolff-Parkinson-White (WPW) Syndrome) using the NICE [3, 10, 11] approach.
When the EPS study is finished all measured data of the NICE pipeline including the CARTO™maps are analyzed in order to validate the quality of the models and the non-invasive estimation of the electrical excitation in the human heart.
When trying to investigate how anatomical models of different tissue compartments get extracted a quantum of publications can be found. When tackling the problem of estimating the electrical spread in the heart the situation of building a model differs from the anatomical model extraction approach. Fine anatomical structures don’t influence the electrical properties of a volume conductor model because of the smoothing properties of the Fredholm integral which describes the relationship between the source points in the heart (transmembrane potential distribution according to bidomain theory) and the potentials on the chest surface. Therefore, these fine anatomical structures can be smoothed out without decreasing the model’s accuracy. Moreover, from a numerical point of view, fine anatomical structures give rise for degenerated triangles, which may cause numerical instability when performing the estimation of the electrical spread.
In summary, the resolution is influenced by
                    the ill-posedness of the inverse problem,the image modalities (slice thickness of 4 to 10 mm),the smoothing properties of the integral,                
the ill-posedness of the inverse problem,
the image modalities (slice thickness of 4 to 10 mm),
the smoothing properties of the integral,
and, for these reasons, advancing the discretization does not improve the quality of the results.
To create a volume conductor model in order to estimate the electrical spread in the human heart, the decision of the active compartments needs to be done [6]. The volume conductor model comprises the electrically most active compartments. For our model these compartments are:
                    chest (medium conductivity, surface electrodes),lungs (low conductivity, filled with air),atrial and ventricular blood masses (high conductivity),atrial and ventricular myocardium (medium conductivity, electrical sources).                
chest (medium conductivity, surface electrodes),
lungs (low conductivity, filled with air),
atrial and ventricular blood masses (high conductivity),
atrial and ventricular myocardium (medium conductivity, electrical sources).
Fig. (2) shows a patient-specific volume conductor model in different perspectives.
As a result of the variety of the different compartments, the volume conductor model requires different compartment-specific approaches, which had to be developed. The reason is that there is no uniform segmentation approach capable of extracting different compartments. Furthermore, there are two pre-processed data sets (short-axis, axial) to handle the modeling task. These compartment-specific steps can be executed sequentially, and, in a more global view, the compartments can also be extracted using a pipeline.
To have a homogeneous and clinically applicable software the Medical Segmentation Toolkit (MST) is used. MST enables an easy integration of different state-of-the-art frameworks and segmentation methods. The framework enables an easy development of segmentation pipelines to extract different compartments semiautomatically after initial parameter settings. A detailed explanation is given in [16].
The chest can be segmented quite simply using a seeded region growing algorithm [17]. The result of this segmentation approach, with the seed point at a voxel outside the torso boundary, is the surrounding volume of the chest. To get the chest volume as needed, the segmentation result has to be inverted. After this a smoothing needs to be done in order to get an accurate chest model. Although the above described approach is trivial and elegant it does not fulfill our conditions completely. Therefore, a more specific method was created to extract a homogenous and symmetric chest model with the arms cut of at an initial position. This position is placed where the arms no longer touch the torso. Furthermore, both arms have to be cut off at the same slide (position) in the image data to get a symmetric chest model.
First of all the image data are prefiltered by a Roberts Cross function [18]. It highlights regions of high spatial gradient measurements, which corresponds to edges. A big advantage of the Roberts Cross function is that no parameters need to be set and it can be computed quickly because only four input voxels have to be examined to compute the new output values of the image. Because of the small input mask, the Robert Cross filter is sensitive to noise, but in our case this is not crucial because we are only interested in the outer boundary of the chest.
In the next step the algorithm searches the position of the image where the chest’s border appear for the first time. This row position is the starting vector for extracting the chest and separating the arms. Therefore, on the most left and most right voxel of the initial position a beam with a 45 degree angle is projected to the chests border. After this projection the left beam tries to reach the last row of the image by following the left border of the chest. The left image in Fig. (3) shows an example where the algorithm was able to separate only one arm, which means that both arms remain part of the model. The right image in Fig. (3) shows the algorithm succeeding in separating both arms. From now on, the arms are separated and cut off in the model. Although this separating procedure is not crucial for our estimation of the electrical excitation in the human heart approach, it helps generate symmetric models.
The advantage when trying to segment the lungs is that the gray values differ intensely from the surrounding tissue. Although the extraction approach seems to be simple another problem arises: the left and the right lungs are often in immediate contact. The left and the right lungs are, however, needed as separated compartments, and, therefore, the segmentation process needs to take care of this problem. The method described in [19] yields good results but requires user input. For extracting a rather good representation of the lungs without manual interaction the algorithm described in [20] can be used. In principal, the image is thresholded to separate the lungs from surrounding fat, then the chest-surrounding air, noise and airways are removed, a rolling-ball operator can be used to rebuild the lung borders, and, as a last step, the left and the right lungs are separated and identified by a connected component labeling.
The blood masses are highly electrically active and, furthermore, the blood masses provide the a-priori information for the myocardium reconstruction process. On the basis that Active Appearance Models (AAMs) have been shown to be useful for interpreting deformable objects, this technique was chosen to extract the cardiac blood masses [21, 22]. AAMs are generative models capable of synthesizing images of a given object class. AAMs contain statistical models of shape and gray level appearance of objects. AAMs can also be used to fit the model in an unseen image, and, therefore, be applied to determine the target structure in the input image.
For extracting an object using AAMs training sets have to be created. The target structure or shape needs to be marked in these training sets using corresponding landmark points. A shape is described by a set of n points that can formally be described as a vector
 (1)x=x1,...,xn;y1,...,ynT.                
The creation of s training samples means that s vectors have to be generated. Normally, a human expert annotates the training samples by identifying good landmark points. Such landmarks are points of high curvature or junctions. Because this procedure is a time-consuming and costly process, problem specific automatic landmark placement methods have been developed [23] but our model was generated by placing the landmark points manually by an expert. Henceforth, it has to be guaranteed that all shapes are in the same coordinate frame to apply statistical analysis. Thus, the sum of squared distances of each shape to the mean value   D=∑xi−x¯2 has to be minimized. An appearance model represents shape and texture learnt from the training sets. The shape and texture are represented as vector x and g, respectively:
(2)x=x¯+QSc;
(3)g=g+Qgc.                
The parameter vector c controls shape and texture, x¯ is the mean shape, and  g¯ is the mean texture. The matrices  Qs and Qg describe the modes of shape and texture variation, respectively.
An AAM seeks to minimize the difference between an unseen image and the ones created by the appearance model. Therefore a difference vector δI can be defined as
(4)δI=Ii−Im,                
where Ii describes the vector of gray-level values in the image, and Im stands for the gray-level vector of the current model. To get the best match between an unseen model and one generated by the AAM, the magnitude difference vector has to be minimized Δ=δI2. Varying the shape and texture control parameter vector c solves this optimization problem. More detailed information is available in [21, 23-25]. For creating the AAM we integrated the AAM-API [26, 27] into MST.
For establishing the AAM 71 training sets (cine-gated, short-axis scans) were used. Every image set was annotated using 99 annotation points. These annotation points were grouped as follows: 33 points were used to specify the outer boundary of the left ventricular myocardium, 33 landmarks were used to describe the left ventricular blood mass, and the remaining 33 landmark points were used to describe the right ventricular blood mass. Although the specifying of the outer boundary is not mandatory, this description was made, firstly, to have a possibility to check the myocardium reconstruction accuracy and, secondly, to easily initialize the model’s search procedure.
The search procedure starts after mean model insertion in the image data. In a next step the mean model gets initialized, which means to locate the left and right ventricular blood masses best possible only by using the mean model information. After this procedure the starting vector for the AAM search is defined. From the time when the initialization is done, the model fit approach (AAM search) starts until the search converges. Because the likelihood that the adjacent images have a related shape and gray-level appearance the finding of the prior arranged search is used as starting vector in the adjacent images. This approach is repeated from apex cordis up to the base of the heart. The approach extracts the separated blood masses of the left and right ventricle, as shown in Fig. (4).
Due to the more complex geometry of the atria in comparison to the ventricles the appearance models and the associated search procedure need to be handled in a different way. The orifices of the pulmonary veins, orifices of superior and inferior vena cava, tricuspid and mitral annuli, and right and left appendages give the complex geometry of the atria. Accordingly, a huge shape variation has to be dealt with. Three separate appearance models were created. The atria are divided into three divisions of appearance. The first division reaches from the base of the heart to the first appearance of the blood masses of the left upper (LUPV) and the left lower (LLPV) pulmonary vein. The second division continues from this position to the last appearance of the LUPV and LLPV blood masses, and the third division spans the region from there to the end of the appearance of the atria in the image stack. The end is defined by the last appearance of the right lower (RLPV) and right upper (RUPV) blood mass. The same divisions are used for the left atrium. This is done in order to extract the left and the right atrial blood mass with one and the same AAM, which helps reduce global complexity. Like the shape description method used for the ventricles, also 99 annotation points or landmarks were used to annotate 175 atrial training images (cine-gated, short-axis images). With 33 annotation points the left atrial blood mass is defined, with the following 33 points the right atrial blood mass is defined and the remaining 33 points are used to describe the cardiac boundary. The description of the cardiac boundary alleviates the initial finding of the blood masses. The blood masses are then segmented the same way as described for the ventricular blood mass search. More information can be found in [28].
Because of the used MRI settings the myocardium can not be detected by a human expert in the volume data at any location, especially this remains true for the atrial myocardium caused by the imaging modalities (slice thickness 4 mm). Therefore, a-priori information needs to be used in order to reconstruct or estimate the myocardial model using an algorithm. For the myocardial reconstruction, operations of mathematical morphology [29], especially dilation operations, are employed. The approach is based on circles (structuring element) with a radius range from a minimum to a maximum myocardial thickness. These circles roll around the blood mass boundary and try to detect the myocardial structure by probing all related voxels if they are myocardial voxels or not. If the probed voxel is below a predefined lower value or exceeds an upper value then the algorithm chooses a mean myocardial thickness. This situation occurs predominantly when reconstructing the atrial myocardium, and, therefore, one can speak of ”myocardium estimation”. A precise description of the blood mass extraction and the myocardial reconstruction approach can be found in references [28, 30].
Upon completion of the compartment extraction, these parts need to be coupled together to the patient-specific volume conductor model. The environment chosen to create the patient-specific 3D model is AmiraDev™ 3.0 (TGS Europe Inc.). This environment is a visualization tool, which also allows creating triangular meshes. Furthermore, the functionality of the environment can be expanded by self-developed plug-ins. In our case the complete non-invasive cardiac imaging software packages were developed as AmiraDev™ plug-ins.
The labeled image data are first smoothed to eliminate sharp edges and then triangulated using a standard marching cubes algorithm provided by AmiraDev™. In addition, a remeshing process guaranteeing quality standards (equilaterality of triangles) is performed to qualify for a Boundary Element Method (BEM) needed for solving the inverse problem.
In a next step an in-house developed software package (Amira plug-in) checks if triangles of the triangulated and smoothed compartments have intersections. This quality check is necessary because an intersection of two or more compartments results in numerical errors during activation time estimation. If an intersection is present, the intersecting triangles need to be moved. A basic rule is that the triangles of passive compartments (chest, lungs) should be moved until no intersection occurs. Fig. (2) shows such a triangulated and ready-to-use patient-specific volume conductor model.
The body surface potential (BSP) map is acquired in 62 channels by the Mark-8 system (Biosemi V.O.F.). The Wilson-Central-Terminal (WCT) defined the reference potential [31]. The sampling rate was 2048Hz. Signals were bandpass filtered with a lower and upper edge frequency of 0.3 and 400Hz, respectively. The AC-resolution of the system was 500nVbit-1 (16 bits per channel).
After transformation of the electrode coordinates into the MRI frame, using affine registration provided by the Polhemus Software package, the leadfield matrix L is calculated by employing a BEM formulation. The leadfield matrix represents the relation between the electrical sources in the heart and the electrical potentials in the electrodes placed on the chest of the computer model. The conductivities were chosen according to [32]: myocardium (intra- and extracellular): 0.1 Sm-1; lungs: 0.08 Sm-1; blood masses: 0.6 Sm-1; chest: 0.2 Sm-1. The inverse solution via activation time imaging is computed by minimizing the following cost function:
(5)LΦm−DF2+λ2ΔτF2→min;
where the surface Laplacian △ is introduced in (5) in order to avoid unphysiological patterns by smoothing the solutions of the activation time patterns. The parameter λ controlls the amount of regularization. The optimal value of the regularization parameter is computed by using the L-curve-method [33]. This parameter is necessary to regularize the ill-posed problem cost function given in (5). The matrix D contains the measured (time discrete) ECG data in the electrodes and ⋅F represents the Frobenius norm. A Quasi-Newton solver was used for minimizing the functional in (5). A detailed explanation can be obtained in [10].
When facing the challenge to solve the ill-posed problem of non-invasive cardiac electrical source imaging many circumstances will influence the result. First of all, the forward problem has a unique solution whereas the inverse problem cannot be solved uniquely. Because of this, the inverse problem depends on any available a-priori information. One also needs to be careful in the representation of the data uncertainties. Furthermore, the ECG signal has to be of high quality, the model error of the volume conductor needs to be as small as possible, and the coupling of the different coordinate systems (MRI coordinate system, global coordinate system of the electrodes, CARTO™) also needs to be done carefully to keep the global model error low, because small changes in the system may affect the result dramatically.
The CARTO™maps created during the EPS by the cardiologist represent the gold standard with regard to electroanatomical function in the target chamber. Therefore, after the interventional treatment all relevant data are compared with the gold standard to assess the quality of the NICE approach [5, 34, 35].
In addition to this check, the generated models, using the AAM approach, were compared to an expert segmentation. Due to the fact that there is no gold standard in segmentation, the human experts’ segmentation was assumed to be the gold standard. Therefore, the blood mass models were extracted by a human expert and the AAM approach, and the segmentation results (binary images) were evaluated in reference to their similarity. The binary Dice [36] similarity coefficient was used to compute the similarity between the approaches. The Dice coefficient was calculated for the ventricular and atrial blood mass models, which were created by a human expert, and the ones created by the AAM approach. The mean coefficient for the ventricular and atrial blood mass is 0.8917 and 0.8665, respectively. The Dice binary similarity coefficient is defined as:
  (6)DSC=2|A∩B||A|+|B|,            
where A and B are the image objects, the operator |.| computes the cardinality of a set and ∩ finds the intersection of two sets.
The patient-specific volume conductor modeling approach was tested in eight different patients [11]. Fig. (5) shows a triangulated representation of the patient-specific chest and the separated lungs, using an axial scan. The left image (last row) in Fig. (2) shows the chest and the lungs superimposed to the MRI volume data.
The cardiac models were extracted based on a cine-gated short-axis scan. Fig. (6) shows the triangulated left and right atria and the ventricular model with its blood masses. The right image (last row) in Fig. (2) shows the atria and the ventricles superimposed to the short-axis cine-gated MRI volume data.
These compartments are combined together to the so-called patient-specific volume conductor model that enables the estimation of the electrical excitation in the heart. Fig. (7) illustrates the early activation time map (the early activation time is colored in red; the accessory pathway is located left lateral), computed with our software package.
The positions at which the cardiologist performed the ablation procedure to disconnect the accessory pathway that caused the Wolff Parkinson White (WPW) syndrome is marked by spheres. The difference of the estimated position and the position found by the cardiologist using the CARTO™system is about 1 cm. The reason for this localization difference is mainly due to the above mentioned measurement errors and the fact that the inverse problem solution can only be computed by approximation. One has to keep in mind, however, that the CARTO™system does not provide exact solutions as well.
The overall calculation time for estimating the activation time maps was in the same order of the time necessary for mapping the basal area of the ventricles using CARTO™. The mean segmentation time for a patient-specific model was about 25 min using a Pentium IV with 3.2 GHz clock speed and 1 GB of main memory (RAM). Compared to a manual segmentation procedure the segmentation pipeline enables the non-invasive cardiac imaging process to become clinically applicable. Furthermore, with the activation time imaging approach maps can be computed for both chambers, whereas the conventional CARTO™ system is able to image only one target chamber.
The goal of this work was to develop a method for constructing a patient-specific volume conductor model in a fast and accurate way in order to estimate the electrical excitation in a human functional heart model for clinical applications. The development of the MST framework allows creating tissue-specific segmentation pipelines due to the clear, homogenous and, thus, easy-to-use interface. The possibility to integrate different frameworks into MST enables to increase functionality without increasing complexity.
The extraction of the ventricular and atrial blood masses yielded the same quality as the ones obtained by human experts. The myocardium extraction or estimation, in case the a-priori information had to be used, proved successful, but with the addition that the complex geometry of the atria with its orifices (especially the pulmonary veins) needed sometimes little manual corrections.
By obtaining the morphological image data using computed tomography (CT) the accuracy of the myocardium could be increased, but the radiation exposure and the use of a contrast agent does not legitimate this procedure. Furthermore, the ill-posed nature of the approach along with the smoothing properties of the Fredholm integral limits the quality of the results anyway.
At this time the VCM is a static one; the ventricular and the atrial model characterize the systole of the heart. Although it is possible to generate a patient-specific cardiac model at different trigger stages using this approach, the calculated time-dependent leadfield matrix L, needed for performing the simulation, would result in an extreme amount of data and computational time - in an exponential order. Theoretically, such a time-dependent leadfield matrix would allow a more precise simulation, the calculation time and the handling of these large data sets would render the problem insolvable for a state-of-the-art workstation.
When performing non-invasive cardiac imaging many different steps have to be combined. For achieving best possible results the whole non-invasive cardiac imaging workflow needs to be processed precisely to keep the mean model error at a low level.
The creation of a semi-automatic volume conductor modeling pipeline enables the NICE approach to be clinically applicable. The effort to create a modeling pipeline that is able to extract the relevant compartments in a short time with high accuracy increased the overall model quality and decreased the user interaction complexity.
Our clinical NICE studies show that this technique is feasible and supports the cardiologist with important information.
