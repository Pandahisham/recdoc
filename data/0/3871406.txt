A Novel Data-Driven Approach to Preoperative Mapping of Functional Cortex Using Resting-State Functional Magnetic Resonance Imaging

Supplemental Digital Content is Available in the Text.
Recent findings associated with resting-state cortical networks have provided insight into the brain's organizational structure. In addition to their neuroscientific implications, the networks identified by resting-state functional magnetic resonance imaging (rs-fMRI) may prove useful for clinical brain mapping.
To demonstrate that a data-driven approach to analyze resting-state networks (RSNs) is useful in identifying regions classically understood to be eloquent cortex as well as other functional networks.
This study included 6 patients undergoing surgical treatment for intractable epilepsy and 7 patients undergoing tumor resection. rs-fMRI data were obtained before surgery and 7 canonical RSNs were identified by an artificial neural network algorithm. Of these 7, the motor and language networks were then compared with electrocortical stimulation (ECS) as the gold standard in the epilepsy patients. The sensitivity and specificity for identifying these eloquent sites were calculated at varying thresholds, which yielded receiver-operating characteristic (ROC) curves and their associated area under the curve (AUC). RSNs were plotted in the tumor patients to observe RSN distortions in altered anatomy.
The algorithm robustly identified all networks in all patients, including those with distorted anatomy. When all ECS-positive sites were considered for motor and language, rs-fMRI had AUCs of 0.80 and 0.64, respectively. When the ECS-positive sites were analyzed pairwise, rs-fMRI had AUCs of 0.89 and 0.76 for motor and language, respectively.
A data-driven approach to rs-fMRI may be a new and efficient method for preoperative localization of numerous functional brain regions.
AUC, area under the curve
BA, Brodmann area
BOLD, blood oxygen level dependent
ECS, electrocortical stimulation
fMRI, functional magnetic resonance imaging
ICA, independent component analysis
MLP, multilayer perceptron
MP-RAGE, magnetization-prepared rapid gradient echo
ROC, receiver-operating characteristic
rs-fMRI, resting-state functional magnetic resonance imaging
RSN, resting-state network

An ongoing challenge in surgical resection of brain lesions is balancing the goal of maximizing resection with the need to preserve function. This is especially salient in the setting of epilepsy and glioma surgery where the lesions can be cortically based and intimately involved with eloquent regions. In both situations, resection around a seizure focus or maximizing tumor removal enhances clinical outcomes with regard to seizure freedom or survival, respectively.1-6 The benefits of a larger resection, however, must be weighed against the cost of deficits incurred in areas of eloquent cortex, particularly in motor and language areas.5 Because there is a high degree of individual variability in these areas, presurgical localization and intraoperative cortical mapping are often required to optimize the clinical outcome.
Functional magnetic resonance imaging (fMRI) has played an important role in the preoperative assessment of patients with lesions adjacent to eloquent cortex. fMRI measures neuronal activity using the ratio of oxyhemoglobin to deoxyhemoglobin as a contrast mechanism (known as blood oxygen level-dependent [BOLD] fMRI). In a typical block-design application, the subject alternates between a passive resting state and performing a task. Clinical applications of task-based fMRI have focused on localizing areas of critical function for presurgical planning7 and have been shown to correlate with intraoperative electrophysiology,8 Wada testing,9 and prediction of loss of function postoperatively.10 Despite its utility, task-based fMRI has several disadvantages that limit its application for preoperative functional localization. First, the results are dependent on how well the patient can perform the prescribed task. In the setting of a brain tumor, cooperation and effective participation may be impaired due to neurological deficits or confusion.11 Second, because the patient must be awake during the imaging procedure, sedation cannot be used. This often limits effective imaging in pediatric populations for whom conscious sedation is frequently necessary. Finally, task-based fMRI can be lengthy if multiple functional sites are interrogated in a single imaging session.
As an alternative to task-based fMRI, resting-state functional MRI (rs-fMRI) has been proposed as an imaging methodology for localizing critical sites independent of patient participation.12 This approach uses the endogenous brain activity detectable with BOLD MRI to identify areas that are interacting at rest. Spontaneous BOLD fluctuations are low-frequency (<0.1 Hz) oscillations in metabolic activity that are anatomically correlated within distinct functional networks.13 First reported by Biswal et al,14 there is strong coherence which is reproducibly present between the left and right somatomotor cortices,15 between language areas,16,17 and between numerous other functional regions in the absence of task performance. Using spontaneous activity, one can generate resting-state correlation maps that are similar to the functional maps obtained from task activations.18 This approach has a number of advantages. Most importantly, patient participation is not required. An additional advantage is that these methods are robust; spontaneous fluctuations have been shown to persist under conditions of sleep19-21 and anesthesia,22-25 as well as in the presence of tumors.12 Thus, resting state could potentially be widely applied irrespective of age and cognitive status. Although holding substantial promise, these advanced techniques have not yet entered routine clinical practice due to the high level of technical support necessary to create these resting-state maps. A common approach for network identification is the selection of a “seed region” in a characteristic location (such as the hand-motor area to identify the somatomotor network). This approach can be biased by the selection of seed regions and is technically labor intensive. Often multiple regions are tested until the optimal network is identified. Although this process is often successful in normal brains using standard atlas coordinates, it becomes more challenging in brains that are distorted due to disease (ie, tumors and cortical dysplasia). Finally, rs-fMRI has had limited comparison with the clinical gold standard of electrocortical stimulation (ECS).
In this study, we evaluated the use of a novel methodology for identifying resting-state networks (RSNs) with fMRI as a potential tool for preoperative imaging. Using a multilayer neural network technique, we have developed an approach that enables the identification of multiple functional networks from a single task-independent dataset. Moreover, these networks are identified automatically in a purely data-driven approach independent of the need for an individual to pick seed regions. To assess the validity of the imaging findings as a potential clinical tool, language and motor networks were rigorously compared with the gold standard of ECS to localize essential eloquent cortex in patients with epilepsy. Additionally, to assess the robustness of our technique in the presence of lesions, the technique was applied to 7 patients with tumors. Taken together, these findings support the potential utility and augmented capability of rs-fMRI to enhance preoperative localization of functional regions.
Six patients undergoing surgical treatment of intractable epilepsy and 7 patients undergoing surgical resection of brain tumors participated in this study, which was approved by the Human Research and Protection Organization at Washington University School of Medicine (Tables 1 and 2). Before inclusion, all patients gave written informed consent. With regard to the tumor subjects, 7 participants who were screened as potential candidates for an awake craniotomy for tumor resection were included. All subjects had anatomic and rs-fMRI before resection. Two underwent functional mapping with ECS. With regard to the epilepsy subjects, all participants had epileptic seizures refractory to treatment with antiepileptic medications and had previous documentation of epileptic seizures by video scalp electroencephalographic monitoring. All subjects were deemed candidates for invasive monitoring. Before surgical implantation of electrodes, all subjects underwent anatomic and rs-fMRI imaging. Subjects underwent intracranial electrocorticographic monitoring to localize the epileptogenic zone of seizure onset and to perform functional mapping with ECS. Exclusion criteria included the presence of dysplastic cortex on clinical magnetic resonance imaging (MRI). Each patient underwent an initial craniotomy for the subdural placement of an electrode array that was then removed with a second craniotomy approximately 1 week later during resection of the epileptic foci.
Demographic and Clinical Information for Seizure Patientsa
Demographic and Clinical Information for Tumor Patientsa
All patients were scanned using a 3-T TRIO scanner (Siemens, Erlangen, Germany). rs-fMRI data were acquired using a T2* EPI sequence (1 × 1 × 1-mm voxels; 128 volumes/run; TE = 27 ms; TR = 2 s; field of view = 256 mm; flip angle = 90°), while the patients were instructed to remain still and fixate on a visual cross-hair without falling asleep. Anatomic imaging included T1-weighted magnetization-prepared rapid acquisition gradient echo (MP-PAGE) and a T2-weighted fast spin echo scan. All magnetic resonance data were acquired in approximately 30 minutes for each patient. rs-fMRI data were preprocessed using the methods detailed in Zhang et al.26
rs-fMRI correlation maps were generated using a multilayer perceptron (MLP), an artificial neural network.27 MLPs are supervised classifiers that are trained to map input data to predefined output classes using 1 or more hidden layers (Figure 1).28,29 In this work, the MLP was previously trained to associate correlation maps generated from canonical ROIs with a priori class labels corresponding to seven predefined RSNs.30 The MLP consists of one input, hidden, and output node layer, fully connected in a feed-forward manner. Each training input was a correlation map (masked to include only gray matter voxels) generated from one of 169 canonical seed regions of interest (ROIs) across 21 normal control subjects. Each node in a particular layer is connected to each node in the subsequent layer, and it is the strength, or weight, of these connections that allow the MLP to classify the input data. Thus, the input image is propagated through the layers of the MLP; the output was then compared with a 7-dimensional binary output label vector (with a value of unity for the RSN to which the ROI is assigned, and zeros for the others). The difference of the output and the training label generated an error signal; the backpropagation algorithm29 was used to minimize the squared error across all RSNs for all correlation map training inputs. At each training iteration, performance on canonical ROIs was computed in a second “optimization” dataset (n = 17). Training was halted on reaching minimal error in the optimization dataset then tested in a third, validation dataset (n = 10) to ensure that overfitting had not occurred in the training or optimization datasets.27
Voxel-wise classification of resting state networks (RSNs) using the multilayer perceptron (MLP) algorithm. Voxel-wise correlation maps were obtained from resting state functional magnetic resonance imaging data and masked to include only gray matter voxels. The masked images were then passed into the MLP algorithm (see text), which produced RSN maps for the language network (LAN), somatomotor network (SMN), visual network (VIS), dorsal attention network (DAN), ventral attention network (VAN), frontoparietal control (FPC), and default mode network (DMN).
The training process allowed the MLP to learn a mapping between rs-fMRI correlation maps (from seeds across the brain) and RSN identity. After training, the MLP was applied comprehensively to the entire brain by generating a correlation map for each voxel (treating each voxel as a seed) and then computing RSN estimates by propagating this map through the MLP. Thus, the MLP was used to generate a 7-dimensional RSN estimate for every voxel. In other words, for each RSN, a whole-brain image was produced with an estimate of the likelihood of membership at each voxel.
In those patients with tumors, lesions were manually segmented from T1- and T2-weighted images. For each tumor patient, a new MLP was trained using a process identical to that described previously, with the following changes. First, all correlation maps in the training data that were generated from ROIs that intersected the lesion were omitted. Second, the gray matter mask defining the input layer of the MLP was modified to exclude all lesion voxels. The new MLP was then applied to the individual patient, again operating on voxel-wise correlation maps but now ignoring any voxels within the lesion.
To determine the probability that an electrode covers a portion of an RSN, electrode MRI coregistration was performed as described in the next section. The results of the MLP analysis for gray matter voxels located within 30 mm of the electrode were averaged with a weight that was inversely proportional to the square of its distance from the electrode. The inverse square law describes the behavior of voltages in the brain that arise from electrical dipoles. This analysis was performed for each of the 7 RSNs, and the results were normalized so that a sum over the probabilities for all networks was equal to 1 for each electrode.
The method that we have developed allows for the precise alignment of the subdural grid to the surface of the brain and is similar in concept to the methods used by Hermes et al31 and He et al21 Preoperative MP-RAGEs were acquired using standard clinical protocols. Computed tomography (CT) images were acquired before removal of the grid. CTs were transformed to atlas space using a cross-modal procedure based on alignment of image gradients32 in which the CT image is aligned with the individual subject MP-RAGE, and the MP-RAGE is then transformed to an atlas-space33 representative target using a 12-parameter affine transformation. Electrodes in the CT image were often found to be in contiguous clusters due to artifact induced by the presence of wires and the extreme intensity of metal electrodes in x-ray-based modalities. Electrodes were segmented by a combination of voxel erosion, a 5- mm gaussian blur, and thresholding. Center-of-mass coordinates from clusters of face-contiguous voxels were isolated using an in-house clustering algorithm. A supervised electrode trimming tool (designed in MATLAB) was used to remove remaining metal artifacts (eg, wires, clips) as well as sort the grid electrode coordinates.
Due to rigidity of the grid materials, the locations of the electrodes at the time of CT acquisition are generally displaced inward relative to the location of the subject's cortical surface at the time of MRI acquisition. To correct for this, electrode coordinates were projected to the surface of the brain along a path normal to the surface of the grid. The surface anatomy used in this procedure was extracted using Freesurfer 5; the segmented pial surface was filled and then blurred modestly (2 mm) such that electrodes arrive at a location reflecting the smoothed convexity of the brain.
Electrodes were classified as covering eloquent cortex or not with the use of the gold standard of ECS mapping. For the epilepsy patients, ECS mapping was performed independently by a neurologist in the extraoperative setting to localize motor, sensory, and language cortex before subsequent resection of seizure foci. This mapping took place late in the telemetry, after the successful identification of seizure foci and before the second craniotomy. ECS was performed using cortical stimulation with bipolar stimulation of pairs of adjacent electrodes at a frequency of 60 Hz and pulse width of 500 ms. The current was gradually increased from 1 mA to 10 mA or until the afterdischarge threshold was reached. Stimulation duration for motor and language mapping was 3 to 5 seconds. For each stimulated electrode pair, motor regions were defined by the presence or absence of induced involuntary motor movements. Language sites were noted when speech arrest occurred during the stimulation of an electrode pair (Figure 2A). For the tumor patients, the process of ECS mapping was similar to that in the epilepsy patients, but was performed intraoperatively using a hand-held Ojemann stimulator (rather than a gird array of electrodes) before tumor resection. Otherwise the stimulation parameters were similar. Only ECS-positive sites were noted in the tumor subjects and registered in 3-dimensional space on an MP-RAGE T1-weighted MRI scan (using Medtronic Stealth Navigation System; Medtronic, Minneapolis, Minnesota) and subsequently coregistered in the method described earlier.
Schematic for classifying electrodes as motor or language positive using resting state functional magnetic resonance imaging and the gold standard electrocortical stimulation (ECS) in epileptic patients. A, 7 resting-state network (RSN) maps were constructed using the multilayer perceptron (MLP) algorithm for each patient. From these 7 networks, motor and language maps were investigated further; after coregistering the electrode grid to the magnetic resonance data, gray matter voxels located within 30 mm of each electrode were averaged with a weight that was inversely proportional to the square of its distance from the electrode. Electrodes greater than a minimum threshold were then classified as motor or language positive for the MLP (red triangles). This threshold was varied to obtain receiver-operating characteristic curves. B, ECS was used as the gold standard for identifying motor and language cortex. All electrodes that did not evoke a functional response were classified as ECS negative. For the high ECS sensitivity method of classifying ECS electrodes, any site evoking a motor or language response was classified as ECS positive. This method was also used to perform a pairwise analysis. For the high specificity method of classifying ECS electrodes, electrodes that were associated with a functional response were classified as ECS positive, provided that they were not also involved in a stimulated pair that did not evoke a response, in which case they were still labeled ECS negative.
For the epilepsy patients, electrodes were classified as motor or language positive using 3 different methods of classification. In all 3 methods, any electrodes that did not evoke a motor or language response when stimulated were labeled negative. In the first more sensitive method (Figure 2B, high ECS sensitivity), all sites inducing a motor or language response were classified as ECS positive. In the second method (Figure 2B, high ECS sensitivity, pairwise), all sites inducing a motor or language response were considered ECS positive as a pair. In the third more specific method (Figure 2B, high ECS specificity), electrodes that were associated with a motor response when stimulated were classified as motor positive, provided that they were not also involved in a stimulated pair that did not evoke a response, in which case they were still labeled negative. This method was more restrictive and resulted in fewer electrodes being classified as motor positive. Because there was a limited number of electrodes associated with speech arrest, there was an insufficient number of electrodes with which to use this method of classification for language sites.
The result of the MLP analysis for a single electrode was a 7-element vector representing the likelihood that the electrode was a member of each of the 7 RSNs. As a method of validation, in this study, we focused primarily on the motor and language networks in the epilepsy subjects. For those networks, an electrode was classified as positive or negative from the MLP results if the probability was greater than or less than a specified threshold, respectively. This threshold was varied from 0 to 1, and at each threshold, the true-positive rate was plotted against the false-positive rate, yielding a receiver-operating characteristic (ROC) curve. Each epilepsy patient was analyzed individually, yielding multiple ROC curves for each analysis. These ROC curves were averaged, and the area under the curve (AUC) for this line was used as a measure of the agreement between the MLP method and the gold standard ECS method.
In the case of the high ECS sensitivity pairwise analysis, the ROC curves varied slightly. The MLP results were considered in pairs of cortical regions related to the ECS electrode pairs overlaying them. An MLP pair was considered positive if either 1 or both of the pairs of cortical regions were positive for motor or language because this implies that eloquent cortex was present in the area of at least 1 of the ECS electrodes.
For the comparison of fMRI analysis and ECS mapping in tumor patients, a quantitative analysis was impossible because negative ECS results were not recorded. However, ECS-positive sites were recorded in 2 patients, making a qualitative analysis possible.
RSN maps were produced for all epileptic patients in the study (Figure 3). For networks in which no direct clinical comparison was possible, the acquired maps were in good agreement with published results. These included the visual network,34,35 dorsal and ventral attention networks,36,37 frontoparietal control network,38-40 and default mode network.41,42 For the motor and language networks, which were compared with the clinical findings using ECS, there was a high degree of qualitative overlap between the 2 methods (Figure 4). The positive motor ECS electrodes were centered in the precentral gyrus. The MLP-derived motor areas encompassed both the pre- and postcentral gyrus. The positive language ECS electrodes were centered in the pars opercularis area of the inferior frontal gyrus (approximately Brodmann area [BA] 44) posterior to the MLP language-positive regions, which were in the pars triangularis of the inferior frontal gyrus (approximately BA 45). Quantitative comparisons were performed with an ROC analysis.
Resting-state network (RSN) maps produced by the multilayer perceptron (MLP) algorithm for the 6 epilepsy patients in the study. For each patient, the language network (LAN), somatomotor network (SMN), visual network (VIS), dorsal attention network (DAN), ventral attention network (VAN), frontoparietal control (FPC), and default mode network (DMN) were all mapped. The raw outputs of the MLP are estimates of the probability of class membership. For the purposes of visualization, the values displayed here are percentiles after rank ordering the data for each RSN across the cortex. PT, patient.
Visualization of the results for motor and language cortex using both electrocortical stimulation (ECS) and the multilayer perceptron (MLP) in the 6 epilepsy patients. ECS results are shown with colored triangles for ECS-positive sites and black circles for ECS-negative sites, whereas the MLP color maps are shown on the cortex surface. In the left column, the high ECS sensitivity method was used to classify motor electrodes as ECS positive (red triangles) and compared with the MLP results (light blue). In the middle column, the high ECS specificity method was used to classify motor electrodes. In the right column, the high ECS sensitive method was used to classify language electrodes as ECS positive (green triangles), with the MLP results displayed in orange. Patient 3 had no ECS-positive language sites and was thus excluded from the analysis.
The results of the ROC pairwise analysis can be found in Figure 5. ROC analysis yielded an average AUC of 0.89 for the motor network and an average AUC of 0.76 for the language network. ROC curves for the nonpairwise analysis can be found in the Supplemental Figure (see Figure 1, Supplemental Digital Content 1, http://links.lww.com/NEU/A585, which shows ROC curves comparing motor and language electrode identification by the MLP algorithm to the gold standard ECS. The gray lines represent ROC curves for the individual patients and the black line is an average over the patients. The AUC listed is for the average over the patients. The top row displays the results of the ROC analysis for the method of high ECS sensitivity classification for motor [Figure 4, column 1] and language [Figure 4, column 3]. The bottom row contains the results of the ROC analysis for the method of high ECS sensitivity classification for motor [Figure 4, column 2]). Using the method of high ECS sensitivity, average AUCs of 0.80 for motor and 0.64 for language were found. When using the method of high ECS specificity, only motor had a sufficient number of electrodes to perform an ROC analysis, and the AUC was found to be 0.82.
Receiver-operating characteristic (ROC) curves for epilepsy patients comparing motor and language electrode identification by the multilayer perceptron (MLP) algorithm with the gold standard electrocortical stimulation (ECS). In this pairwise analysis, an MLP pair was considered positive if either 1 or both pairs of cortical regions were positive for motor or language because this implies that eloquent cortex was present in the area of at least 1 of the ECS electrodes. The gray lines represent ROC curves for the individual patients, and the black line is an average over the patients. The area under the curve (AUC) listed is for the average over the patients. The brains shown are the anatomic representations of these networks for a given threshold; namely, a higher threshold (the lower brain) has elevated specificity and lower sensitivity and a lower threshold (the upper brain) has lower specificity and higher sensitivity.
When evaluating the performance of preoperative rs-fMRI with ECS mapping, the goal was to minimize false negatives, in which electrodes are incorrectly classified as noneloquent cortex by the MLP when they are eloquent cortex as determined by ECS, to reduce motor or language surgical morbidity. To minimize the number of false negatives, a procedure was designed in which a threshold for motor classification was determined, and then a “no-cut” area was expanded around those electrodes to determine how far one must move beyond the MLP classification of motor to minimize false negatives. The results of this analysis for several thresholds can be seen in Figure 6. A visualization of this procedure, performed at a threshold of 85% and a distance of 15 mm (marked by the arrow in Figure 6A), is shown in Figure 6B. For multiple thresholds, at a 15-mm distance from the edge of the motor network, there were only 4 electrodes across the 6 patients that were false negative. Thus, when taken across all electrodes and all patients, the risk probability for missing a stimulation positive site is less than 2% across all thresholds.
The method used to define a no-cut area in epilepsy patients, in which the probability of damage to motor cortex is substantial. A, to define the area, several multilayer perceptron (MLP) thresholds (70th, 75th, 80th, 85th percentiles) were used to classify electrodes as covering motor cortex, and the no-cut zone was expanded around each of the motor electrodes. The probability of a missed motor electrode, which could result in motor deficits, was plotted against the radius of expansion. B, a visualization of the method performed at the 85% and at a radius of expansion of 15 mm. Red triangles mark motor cortex as determined by electrocortical stimulation that were missed by the MLP method. sen, sensitivity; spec, specificity.
The results of the MLP analysis of tumor subjects can be seen in Figures 7 and 8. Figure 7 reveals network distortion in the presence of tumors. The structural images in the left column reveal the extent of the lesion in each patient. Columns 2, 3, and 4 contain axial, coronal, and sagittal views, respectively, of the MLP results displayed in a winner-take-all format. Significant anisotropy across the midline can be seen in the networks present in areas near the tumor, which is consistent with previously published findings.12 Networks were preserved in the presence of a tumor, although they were often shifted from their normal anatomic position. In 3 of the 6 patients (1T, 3T, and 7T), the motor network was shifted posteriorly in the tumor hemisphere relative to the unaffected hemisphere. This effect was particularly pronounced in patient 1T, in whom, in the sagittal view, one can see that the section of motor strip superior to the tumor remains in its normal anatomic location, but the inferior portion was shifted posteriorly to the edge of the tumor. An extension of this effect can be seen in the language area of patient 7T, in whom the language network was shifted posteriorly in the tumor hemisphere. Additionally, networks distant to the tumor also appeared perturbed. In patient 7T, it appears that the visual network has contracted in the tumor hemisphere relative to the nontumor hemisphere despite the tumor being located in the frontoparietal network, where one might assume that it would have no effect on the visual network. This effect can also be seen to a lesser extent in patients 1T and 3T, with the visual network covering a larger area in the unaffected hemisphere than the tumor hemisphere. Despite the level of distortion, for those 2 patients in whom stimulation was performed (Figure 8), there is still agreement between the gold standard of ECS, marked by black dots, and the MLP results, shown as color maps on the cortex surface.
Resting-state network (RSN) maps produced by the multilayer perceptron algorithm for 6 tumor patients in the study. The language network (LAN), somatomotor network (SMN), visual network (VIS), dorsal attention network (DAN), ventral attention network (VAN), frontoparietal control (FPC), and default mode network (DMN) were mapped in a winner-take-all format in the area of the tumor. For the purposes of visualization, the values displayed here are percentiles after rank ordering the data for each RSN across the cortex and subsequently smoothed using a gaussian filter with a standard deviation of 6 mm. PT, patient.
Visualization of the results for identifying eloquent cortex using both electrocortical stimulation (ECS) and the multilayer perceptron (MLP) in 2 tumor patients. ECS results are shown with black circles identifying positive motor and speech sites. The MLP color maps are shown on the cortex surface, with blue representing the somatomotor network and orange representing the language network. Patient 2T had no motor-positive sites identified by ECS so the MLP-identified somatomotor network is not shown. PT, patient.
Although task-related fMRI has shown great promise as a preoperative brain-mapping tool for neurosurgical planning,7-10 the requirement that patients be awake, alert, and cooperative limits its use to a wider patient population.11 More recently, the use of the brain's task-independent endogenous activity has been proposed as a new method to identify eloquent regions in the brain.12 Correlated fluctuations in resting state metabolic activity, as measured with BOLD fMRI, has been well established as a metric for identifying functionally connected networks.13 Previous studies have demonstrated that the cortical topographies associated with a given RSN closely correlate with the cortical regions associated with a task-based activation.18 The feasibility of this approach has been preliminarily investigated in the setting of preoperative brain mapping.12,43,44 Despite the substantial scientific and more limited translational efforts performed thus far, there is still a substantial need for technical expertise to visualize these networks and therefore limited to more specialized centers. The purpose of this study was to investigate the possibility of using a data-driven approach that can rapidly, effectively, and independently identify cortical networks. To achieve this goal, we selected a subset of the identified networks traditionally thought to be eloquent in nature and compared them with the clinical gold standard of ECS. To further define the clinical utility of this approach, we investigated the localization of eloquent cortex in patients with distorted anatomies due to mass lesions. Here we show that through the use of a novel artificial neural network approach, known as the MLP, 7 canonical networks can be identified with a single 30-minute scan. Moreover, there is strong concordance between language and somatomotor RSNs with ECS localization. Taken together, these findings provide evidence that resting state fMRI and neural network classification of imaging data can potentially provide a novel tool for neurosurgical brain mapping in the future.
Two predominant strategies that have been used to map RSNs with rs-fMRI are seed-based correlation mapping (see Introduction and Zhang et al12), and independent component analysis (ICA).34 ICA is often thought of as advantageous because it performs a blind separation requiring no priors and is thus an unsupervised method. However, if ICA is used to localize RSNs, a post hoc assignment must be performed to identify the “correct” component from an arbitrarily ordered set. This is usually performed by expert viewers or by evaluating similarity with a predefined template.45 In addition to the burden of identifying components, there is no guarantee that components recovered in different subjects and identified as a particular RSN (eg, “language”) actually represent the same entity. The MLP is a supervised method trained to identify known RSNs. The outputs of this method always represent the same entity, ordered in the same way. For this reason, the trained MLP represents a fully automated solution to estimating RSNs in individual subjects and is well suited for clinical implementation.27
A cornerstone of this study was the comparison of rs-fMRI to cortical stimulation. The differences in the information acquired from these 2 modalities, however, deserve mention because they affect the interpretation of the results. Although the ROC curves demonstrated good agreement between the MLP and the gold standard of cortical stimulation (particularly in identifying motor cortex), there were also regions that did not overlap. This was in part due to the differences of what each of these modalities detect. ECS identifies only those parts of the cortex “essential” for function; the MLP identifies these regions in addition to regions that may produce deficits detectable only by detailed neurocognitive testing, or not at all. In the case of motor localization, the MLP identifies the somatomotor network, which encompasses both primary motor and primary sensory cortex. ECS, on the other hand, only identifies primary motor cortex by eliciting a motor response. Consistent with this difference, the ECS-positive sites were localized to the precentral gyrus, whereas the MLP-defined motor network included the precentral and postcentral gyri and some insular cortices. The discrepancy in extent of cortex identified with each method was more pronounced with language, where the MLP-defined language network extended broadly beyond cortical areas associated with stimulation responses. The difference between the language ECS-positive sites and the MLP-defined language areas occur because ECS identifies regions that produce speech arrest, whereas the MLP identifies other regions related to the higher cognitive aspects of language. This demonstrated a dissociation between regions related to vocalization (primarily BA 44, REF) vs cognition. This dissociation has 2 major implications for presurgical planning: (1) machine-learning techniques such as the MLP could be specifically trained to localize regions associated with speech (as opposed to language, broadly defined) and (2) inversely, deficits detectable by postsurgical neurocognitive testing could be related to damage to other MLP-defined regions of higher cognitive function. Information of this type could be used to study the relationship between surgical lesions and cognitive deficits related to the various RSNs and ultimately could be used by neurosurgeons to prevent increasingly wider ranges of cognitive deficits. Despite these differences, an important consideration from a surgical planning standpoint is the false-negative rate of a region identified with the MLP. This is the more clinically significant error, namely, when a site is misidentified as being nonfunctional when it actually is eloquent. In the case of motor cortex (due to having sufficient data), we show that the MLP performs reasonably well. The likelihood that an electrode was misidentified as nonfunctional drops substantially between 1 and 2 cm from the border of the functional zone.
To date, fMRI has facilitated a “preoperative anatomic awareness” of an eloquent region's association with a given lesion or site of neurosurgical interest. In essence, this information gives the neurosurgeon helpful, but nondefinitive, information that can aid his or her surgical strategy (eg, regions to avoid, areas that will require intraoperative cortical mapping). The most common types of eloquent cortex are regions subserving motor and language function. Localizing these areas, however, requires that the patient be conscious, attentive, and capable of participating in the given cognitive paradigm. In the setting of a brain tumor, effective participation may be impaired due to a neurological deficit or confusion. Additionally, because the patient must be awake during the imaging procedure, sedation cannot be used, thus eliminating pediatric or claustrophobic patients. Because resting state networks are task independent and have been shown to be present despite the level of consciousness (ie, sleep or anesthesia), the limitations of task-based fMRI do not apply and thus makes this approach substantially more widely applicable. In this study, we have demonstrated that in regard to motor and language function, there is close correspondence between the anatomic locations of motor and language findings identified with the neurosurgical gold standard of cortical stimulation. Although this in no way negates the need for stimulation, it does provide external validation that this automated method identifies useful functionally relevant information that can potentially enhance a surgeon's anatomic awareness of motor and language cortex before surgery.
Having demonstrated a correspondence between the resting-state language and motor networks in patients with normal anatomy, the next phase of the study was to investigate these networks in patients with distorted anatomy. The qualitative correspondence between ECS mapping and MLP results in 2 tumor patients suggests that despite physical perturbation, the MLP was still able to correctly identify networks adjacent to the tumor. In addition to the demonstrated utility of this method for functional localization, these findings also support the durable nature of resting state networks that persist in the presence of physically disruptive lesions. Also of note, there were areas within the tumor that also demonstrated network connectivity. These findings would be in alignment with previously published findings by Skirboll et al46 that found stimulation-positive sites for motor and speech within the substance of the tumor. Beyond perilesional distortions, there were also notable qualitative differences in networks distal to the lesion. Most notably, visual cortex had a reduced anatomic representation ipsilateral to the tumor. These findings could suggest that local dysfunction can have distant effects on networks not directly involved by the tumor. Alternatively, there were also some cortical network assignments for visual cortex that were found in frontal lobe that could also suggest the MLP incorrectly assigned network locations.
In addition to broadening the patient population that can be preoperatively mapped, the use of the MLP for the identification of multiple cortical networks also broadens the capability of what cognitive operations can be assessed and can potentially redefine what regions are considered “eloquent.” The correlation between stimulation mapping and the somatomotor and language RSNs supports that the other cortical networks identified are also functionally relevant. It is important to note that motor and language are the cognitive operations that are typically screened for both preoperatively and intraoperatively. Other cognitive operations of attention, executive control, and sensory perception are challenging if not impossible to screen for pre- and intraoperatively in a comprehensive fashion. Either the number of tasks needed to identify all these functionally relevant regions would simply be too long to test in an MRI, or there are no ways of eliciting or interrupting these complex cognitive operations in the operating room in a reliable way. Although it is critical that a surgeon preserve a patient's ability to move and speak after surgery, these other cognitive operations and their associated networks may also play a role in long-term clinical outcomes, which are harder to test. The use of automated methods to rapidly classify all these networks with a single brief scan may provide an important tool to enable a more subtle appreciation for how these patients will cognitively perform clinically beyond simple motor and language tasks. As an example, identification of the dorsal attention network may better inform a parietal approach to mitigate a postoperative neglect.47 Similarly, a surgery affecting the frontoparietal control network may affect a high functioning professional's decision-making process.38,40 Although the impact of surgery on these various networks needs to be explicitly tested before any clinical recommendations can be made, this approach can at least provide the tool to address such questions.
There were several limitations to the this study. The first limitation was the small number of patients, which permitted meaningful but still preliminary results. More definitive results that will aid in guiding clinical management will require acquiring a higher number of subjects. Second, both the electrode grid coverage and spatial resolution were limited; however, this is typical for the data obtained from current electrocortical grids. Third, this study looked at speech arrest for the identification of language areas using ECS, but for language cortex, identification paraphasic errors also is an important functional measure,48,49 which was not included in the study. Fourth, in the context of tumors, there were some unusual findings in the visual cortical network assignments that could suggest that MLPs may have reduced accuracy when regions are anatomically distorted. Fifth, the study lacked clinical outcomes. Finally, although the group average numbers were encouraging, results for individual patients may not be satisfactory. In particular, despite a low false-negative rate in Figure 6B, 2 of the 4 false negatives were found in patient 3, which could result in surgical morbidity if not correctly identified. Taken together, these results are exciting, but will require a larger clinical series to assess their impact on clinical practice.
The mapping of RSNs defined by rs-fMRI offers a new method for preoperative planning, and the use of the novel artificial neural network presented here can automate and speed the presurgical processing of rs-fMRI data. These techniques not only localize motor and language regions classically understood to be eloquent, but also enables the identification of all the canonical functional networks. Taken together, because this approach is task independent and can identify a multitude of networks simultaneously, these findings stand to enhance preoperative imaging by substantially expanding the patients who can be mapped and better interrogating all regions of function in the human brain.
Dr Leuthardt holds stock in Neurolutions, General Sensing, and Osteovantage. The other authors have no personal financial or institutional interest in any of the drugs, materials, or devices described in this article.
