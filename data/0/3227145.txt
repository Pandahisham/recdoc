Two-stage procedures for selecting the best diagnostic biomarkers

Considered in the paper is the problem of selecting a diagnostic biomarker that has the highest classification rate among several candidate markers with dichotomous outcomes. The probability of correct selection depends on a number of nuisance parameters from the joint distribution of the biomarkers and thus can be substantially affected if these nuisance parameters are misspecified. A two-stage procedure is proposed to compute the needed sample size that achieves the desired level of correct selection, as so confirmed by simulation results.

In the area of diagnostic medicine, a biomarker is used to identify subjects that have a certain condition, e.g. a disease or risk status for the disease, so that proper treatments can be followed (Zhou et al. 2002). Often, multiple candidate biomarkers are developed simultaneously and medical investigators are interested in selecting the one with the highest diagnostic accuracy among these newly identified biomarkers so that future studies can be focused on the selected biomarker.
One approach to achieving this goal is as follows. A number of subjects are randomly selected from a population with the condition and one without the condition, hereafter referred to as ‘diseased’ and ‘non-diseased’ populations, respectively. The candidate biomarkers are then tested on each subject and their diagnostic accuracy is evaluated from the test results. The biomarker that yields the highest (estimated) accuracy will then be identified as the best biomarker.
A key feature associated with such a selection process is the probability of correct selection (PCS), that is, the probability that the selected biomarker indeed has the highest diagnostic accuracy. The number of diseased and non-diseased subjects needs to be sufficiently large so that the PCS can be maintained at a certain desired level. Since the biomarkers are tested on the same subject, their test outcomes from the same subject are correlated, following a multivariate distribution. Thus, the PCS depends on a number of parameters from the joint distribution which have to be specified in order to have an estimate of the sample size. Unfortunately, however, the PCS can be substantially adversely affected if these parameters are not correctly quantified.
To relax the dependence of the PCS on these parameters, we propose a two-stage procedure. First, we randomly select a number of diseased and non-diseased subjects and use the test results from these subjects to estimate the corresponding parameters in the PCS function. Then, the total number of diseased and non-diseased subjects is computed using these estimates that achieve the desired PCS level when the diagnostic accuracy of the best biomarker differs from the other biomarkers by a specified amount. Simulation results are presented to demonstrate the effectiveness of the proposed procedure in achieving the PCS. This paper ends with some discussions in §6.
Suppose there are K candidate biomarkers under consideration, and each yields a binary test result on a subject, 1 or 0, representing the subject being classified as diseased or non-diseased, respectively, by the biomarker. To assess their diagnostic accuracy, these biomarkers are tested on a random sample of m diseased and n non-diseased subjects. For the kth biomarker, its test result is denoted by Xik from the ith diseased subject and Yjk from the jth non-diseased subject. With these notations, the sensitivity (the probability of correctly classifying a diseased subject) of the kth biomarker is pk=P{Xik=1} and can be estimated by pˆk=∑i=1mXik/m. Its specificity (the probability of correctly classifying a non-diseased subject) is P{Yjk=0}=1−qk, with qk=P{Yjk=1} and can be estimated by 1−qˆk, with qˆk=∑j=1nYjk/n. The classification rate θk of the kth biomarker is the sum of the two quantities, i.e. θk=pk−qk+1=P{Xik=1}−P{Yjk=1}+1, and can be estimated subsequently by θˆk=(∑i=1mXik)/m−(∑j=1nYjk)/n+1. The best biomarker is the one with the largest θ, and the one that yields the largest θ-estimate will be chosen as the ‘best’ biomarker. Selection error occurs when the largest θ-estimate is not from the biomarker with the largest θ.
Without loss of generality, we assume that the first biomarker is the best among the candidate markers, i.e. θ1=maxk≥1θk. The lth biomarker is selected as the best if θˆl=maxk≥1θˆk. Therefore, the PCS isρ=P{θˆ1=maxk≥1θˆk|θ1=maxk≥1θk}.
The key issue is to determine m and n so that the PCS will be at least γ, a specified level of probability, under certain parametric configuration of the θs. Usually we require that ρ≥γ when θ1−maxk≥2θk≥Δ, where Δ>0 is also a prespecified constant. For sufficiently large m and n, θˆk(k=1,…,K) follows asymptotically a multivariate normal distribution. Thus if ρ=γ for θ1−maxk≥2θk=Δ, then ρ≥γ for θ1−maxk≥2θk≥Δ. Therefore, the sample sizes m and n are computed by solving the equationP{θˆ1=maxk≥1θˆk|θ1−maxk≥2θk=Δ}=γ.In order to compute the sample sizes, parameters other than Δ which appear in the equation are given values based on ‘educational guess’ or other data sources if possible.
The test outcomes of the K biomarkers from a diseased or non-diseased subject follow a multinomial distribution. Exact calculation of the PCS involves the joint probabilities of {Xi1=0 or 1, …, XiK=0 or 1} and {Yj1=0 or 1, …, YjK=0 or 1}, which becomes extremely complicated when K is relatively large. Instead, we may use normal approximation to relax the computational complexity, assuming that the sample sizes are relatively large.
Write θ=(θ1,…,θK) and θˆ=(θˆ1,…,θˆK). Then by classical asymptotic theory (Bickel & Doksum 1977), θˆ follows asymptotically a multivariate normal distribution with mean vector θ and a variance-covariance matrix given byvar(θˆk)=1mpk(1−pk)+1nqk(1−qk)andcov(θˆk,θˆl)=1m(pk,l−pkpl)+1n(qk,l−qkql),where pk,l=P{X1k=X1l=1},qk,l=P{Y1k=Y1l=1}.
Define δk=θk+1−θ1 and δˆk=θˆk+1−θˆ1, for k=1,…,K−1, and write δ=(δ1,…,δK−1) and δˆ=(δˆ1,…,δˆK−1). Then δˆ is also normally distributed with mean vector δ and variance-covariance matrix Σ=(σkl), whereσkk=var(δˆk)=1m{pk+1+p1−2p1,k+1−(p1−pk+1)2}+1n{qk+1+q1−2q1,k+1−(q1−qk+1)2}andσkl=1m{pk+1,l+1−p1,k+1−p1,l+1+p1−(p1−pk+1)(p1−pl+1)}+1n{qk+1,l+1−q1,k+1−q1,l+1+q1−(q1−qk+1)(q1−ql+1)}.
Let F(x1,…,xK−1;δ,Σ) be the multivariate normal distribution function with mean δ and variance-covariance matrix Σ, then the PCS is approximately(3.1)ρ(δ,Σ)=P{δˆk≤0,k=1,…,K−1}=F(0,…,0;δ,Σ).
The sample sizes m and n are computed from the equation F(0,…,0;δ,Σ)=γ under the constraints that δk=Δ for all k=1,…,K−1.
The asymptotic formula (3.1) of the PCS involves K(K+1) parameters {pk,qk,pk,l,qk,l:1≤k,l≤K,l≠k} from the multinomial distributions. With the K−1 constraints δk=Δ, there are K2+1 distributional parameters (referred to as nuisance parameters) left to be specified in order to solve for sample sizes, assuming that m/n=λ is a known constant. If these nuisance parameters are misspecified, then the PCS can be substantially adversely affected, resulting in an unacceptably high level of selection error; see §5 for numerical demonstration. In order to maintain the desired level of the PCS, we propose, following Stein's (1945) idea, a two-stage selection procedure to compute the required sample size N=m+n=(1+λ)n with ratio λ=m/n fixed.
Step 1. Randomly select m1 diseased and n1 non-diseased subjects from the target populations and test the biomarkers on these subjects. Use the test outcomes Xik, i=1, …, m1 and Yjk, j=1, …, n1 to obtain empirical estimates of the nuisance parameters, given as follows:(4.1)pˆk=1m1∑i=1m1Xik,qˆk=1n1∑j=1n1Yjk,
(4.2)pˆk,l=1m1∑i=1m1XikXil,qˆk,l=1n1∑j=1n1YjkYjl.
Step 2. Plug these estimates into the PCS formula and then solve for sample size N′ from the equation ρ=γ. The required sample size N is then set to max(N1, N′), with N1=m1+n1.
The sample size N computed in this way is no longer a fixed quantity. Rather, it is a random variable, a statistic of the data from the first stage. Note that the estimates in (4.1) and (4.2) are consistent estimators of the corresponding parameters. For sufficient sample size N1, the PCS is expected to be approximately γ regardless of the true values of the nuisance parameters; see simulation results below.
Numerical studies are conducted to investigate the effects of the nuisance parameters on PCS and the performance of the proposed two-stage procedure in maintaining the level of PCS. To reduce the computational burden, we use three biomarkers (K=3) for illustration.
Table 1 presents the values of PCS under various configurations of the parameter space which determine the joint distribution of the three biomarkers, that is, the joint probability of pijk=P{X11=i,X12=j,X13=k} and qijk=P{Y11=i,Y12=j,Y13=k}, for i, j, k=0, 1. These joint probabilities thus give the marginal probabilities, for example,p1,2=P{X11=1,X12=1}=p111+p110p1=P{X11=1}=p111+p110+p101+p100,and so on.
All configurations in table 1 correspond to a fixed value of 0.1 for Δ(=θ1−θ2=θ1−θ3). The first row in the table specifies the parameters used to compute the sample size, for a single-stage procedure, assuming that λ=m/n=1. It turns out that, with this configuration, 102 diseased and 102 non-diseased subjects are needed to achieve a PCS of at least 0.95.
The ρ-values, computed using formula (3.1), in the remaining rows of table 1 are the PCS with 102 diseased and 102 non-diseased subjects under other specifications of the parameter values. We see that the PCS can be substantially lower than the desired level of 0.95 if the parameters differ from the specified values in the first row of the table. For example, if the corresponding parameters from the joint distribution of the three biomarkers take values from the second row rather than as being specified in the first row of the table, then the PCS can be decreased by more than 20%!
To investigate whether the proposed two-stage procedure can relax the dependence on nuisance parameters and maintain the PCS at the desired level, we conducted 10 000 simulations for each configuration of the parameter space in table 1. The simulated values of PCS are presented as ρ* in the last column of the table. For the first-stage sample size, we used m1=75 diseased and n1=75 non-diseased subjects to estimate the corresponding nuisance parameters.
The results in table 1 clearly show that the PCS is maintained at the desired level of 0.95, regardless of the parametric configuration under which the data are generated. Thus the two-stage procedure is proved to be efficient in controlling selection error rates. Numerical results (not shown here) for other configurations and ratios of λ reveal similar findings. With such a multidimensional parameter space, however, it is difficult to characterize any configurations for which the two-stage procedure would perform relatively better.
In this paper, we proposed a two-stage procedure to select the best diagnostic biomarker among a number of candidate markers, and numerically demonstrated its effectiveness in controlling the selection error. While there is no universal standard on how the first-stage sample size is determined, it should be relatively large so that accurate estimates of the nuisance parameters can be obtained. On the other hand, it should not be too large when taking the cost effectiveness of a study into consideration.
We confine our attention to biomarkers with dichotomous outcomes. However, the two-stage approach proposed in this paper can be easily extended to biomarkers with ordinal or continuous test results. In these two cases, an appealing selection criterion is to select the marker that has the largest area under its receiver operating characteristic curve (Hanley 1989).
Various selection problems and related procedures have been discussed extensively in the statistical literature (see Bechhofer et al. 1968; Gibbons 1988), but mostly focusing on multivariate normal distributions. Applications of the selection concepts and theory to the area of diagnostic medicine are relatively new, and many other issues remain to be solved such as selecting a fixed number of best diagnostic biomarkers and selecting the best biomarker (or all biomarkers) that are better than a standard biomarker. Further research efforts are much needed along these lines.
Throughout this paper we assume that the data will be available for all biomarkers from each subject. Very often values on some biomarkers may be missing. One possible approach to dealing with this situation is to use multiple imputation based on the multinomial distributions and then apply the proposed method to the imputed data. The effectiveness of this approach in controlling the PCS needs further investigation. Moreover, selection bias may occur when the subjects are not randomly selected, and correction for such bias in estimating the PCS is desirable.
